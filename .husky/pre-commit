#!/usr/bin/env sh

# Fast, non-interactive checks only; keep this lightweight and cross-platform friendly.

# 1) Type-check
npm run type-check || exit 1

# 2) Color guardrails (inline): fail on raw hex colors or forbidden Tailwind palettes in src/
#    Allow .svg files to contain brand colors.
if git grep -nE '#[0-9a-fA-F]{3,6}\b' -- "src/**/*" | grep -vE '\.svg$' ; then
  echo "❌ Hex colors found in src/ — replace with semantic tokens." >&2
  exit 1
fi

if git grep -nE '\b(bg|text|border)-(red|blue|yellow|orange|slate|green|gray|emerald|stone)-[0-9]{2,3}\b' -- "src/**/*" ; then
  echo "❌ Forbidden Tailwind palette classes found — use semantic tokens." >&2
  exit 1
fi

exit 0
